{% extends 'main/layout.html' %}
{% load static %}

{% block title %}Blog{% endblock %}


{% block content %}
<main>
    <div class="container mt-4">
        <div class="row">
          <div class="col-10 recent-articles">
            <h1>Blog</h1>
            {% if request.user.is_authenticated and request.user.is_staff %}
                <a href="{% url 'blog:create_article' %}"><button type='submit' class='btn btn-primary'>Create new article</button></a>
                <a href="{% url 'blog:create_tag' %}"><button type='submit' class='btn btn-primary'>Create new tag</button></a>
            {% endif %}








            <ul>
            {% if not page.object_list %}
                <p> No results :(</p>
            {% else %}
                {% for article in page.object_list %}
                    <li>
                        <div class="card" style="width: 900px;">
                          <div class="card-body">
                            <h5 class="card-title">{{ article.title }}</h5>
                            <h6 class="card-subtitle mb-2 text-muted">
                                {% for tag in article.tags.all %}
                                <a href="{% url 'blog:tags' tag.slug %}">{{tag.title}}</a>
                                {% endfor %}
                            </h6>
                            <p class="card-text">{{ article.text|slice:'200' }}...</p>
                              <a href="{% url 'blog:info' article.slug %}"><button class="btn btn-success">Read</button></a>
                          </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>



              {% if is_paginated %}
              <nav aria-label="...">
                  <ul class="pagination">
                    <li class="page-item {% if not previous_url %} disabled {% endif %}">
                      <a class="page-link" href="{{ previous_url }}" tabindex="-1">❮</a>
                    </li>


                    {% for n in page.paginator.page_range %}
                      {% if page.number == n %}
                        <li class="page-item active "><a class="page-link" href="?page={{ n }}">{{ n }}</a></li>
                      {% elif n > page.number|add:-3 and n < page.number|add:3  %}
                        <li class="page-item"><a class="page-link" href="?page={{ n }}">{{ n }}</a></li>

                      {% endif %}
                    {% endfor %}
                    <li class="page-item {% if not next_url%}disabled{% endif %}">
                      <a class="page-link" href="{{ next_url }}">❯</a>
                    </li>
                  </ul>
              </nav>
              {% endif %}
            {% endif %}
          </div>
          <div class="col-2 tags">
            <h4>Tags</h4>
            <ul>
                {% for tag in tags %}
                    <li><a href="{% url 'blog:tags' tag.slug %}">
                        <span>{{ tag.title }}</span>
                    </a>
                </li>
                {% endfor %}
            </ul>
          </div>
        </div>





    </div>
</main>
{% endblock %}

